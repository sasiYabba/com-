#5
Iy0qLWNvZGluZzp1dGYtOC0qLQoKaW1wb3J0IHJlcXVlc3RzLGJzNCxzeXMsb3Msc3VicHJvY2Vzcyx0aW1lLGRhdGV0aW1lCmltcG9ydCByZXF1ZXN0cyxzeXMscmFuZG9tLHJlLGJhc2U2NCxqc29uCmZyb20gbXVsdGlwcm9jZXNzaW5nLnBvb2wgaW1wb3J0IFRocmVhZFBvb2wKcmVsb2FkKHN5cykKc3lzLnNldGRlZmF1bHRlbmNvZGluZygidXRmLTgiKQoKdHJ5OgogICAgaW1wb3J0IHJlcXVlc3RzCmV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgIGV4aXQoJ3BpcDIgaW5zdGFsbCByZXF1ZXN0cyAqTm90IEluc3RhbGxlZCcpCnRyeToKICAgIGltcG9ydCBtZWNoYW5pemUKZXhjZXB0IEltcG9ydEVycm9yOgogICAgZXhpdCgncGlwMiBpbnN0YWxsIG1lY2hhbml6ZSAqTm90IEluc3RhbGxlZCcpCnRyeToKICAgIGltcG9ydCBiczQKZXhjZXB0IEltcG9ydEVycm9yOgogICAgZXhpdCgicGlwMiBpbnN0YWxsIGJzNCAqTm90IEluc3RhbGxlZCIpCiMjIyBVU0VSQUdFTlQgIyMjCnVhID0gKCdNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgNS4wOyBMZW5vdm8gQTEwMDAgQnVpbGQvUzEwMDsgd3YpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIFZlcnNpb24vNC4wIENocm9tZS80My4wLjIzNTcuMTIxIE1vYmlsZSBTYWZhcmkvNTM3LjM2IFtGQl9JQUIvTUVTU0VOR0VSO0ZCQVYvMTEwLjAuMC4xNC42OTtdJykKIyMjIExvZ28gIyMjCmxvZ28gPSAiIiIgICAgICAgIApcMDMzWzMxbeKWkeKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWkeKWiOKWiOKWiOKWiOKWiOKVl+KWkeKWkeKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKVlwpcMDMzWzMybeKWiOKWiOKVlOKVkOKVkOKVkOKVkOKVneKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVlOKVkOKVkOKVkOKVkOKVneKWiOKWiOKVkQpcMDMzWzkzbeKVmuKWiOKWiOKWiOKWiOKWiOKVl+KWkeKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVkeKVmuKWiOKWiOKWiOKWiOKWiOKVl+KWkeKWiOKWiOKVkQpcMDMzWzM3beKWkeKVmuKVkOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVlOKVkOKVkOKWiOKWiOKVkeKWkeKVmuKVkOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVkQpcMDMzWzk0beKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKVkeKWkeKWkeKWiOKWiOKVkeKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKVkQpcMDMzWzk0beKVmuKVkOKVkOKVkOKVkOKVkOKVneKWkeKVmuKVkOKVneKWkeKWkeKVmuKVkOKVneKVmuKVkOKVkOKVkOKVkOKVkOKVneKWkeKVmuKVkOKVnSAiIiIKbWJhc2ljX2g9eyJIb3N0IjoibWJhc2ljLmZhY2Vib29rLmNvbSIsImNhY2hlLWNvbnRyb2wiOiJtYXgtYWdlPTAiLCJ1cGdyYWRlLWluc2VjdXJlLXJlcXVlc3RzIjoiMSIsInVzZXItYWdlbnQiOnVhLCJhY2NlcHQiOiJ0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS93ZWJwLGltYWdlL2FwbmcsKi8qO3E9MC44IiwiYWNjZXB0LWVuY29kaW5nIjoiZ3ppcCwgZGVmbGF0ZSIsImFjY2VwdC1sYW5ndWFnZSI6ImlkLUlELGlkO3E9MC45LGVuLVVTO3E9MC44LGVuO3E9MC43In0KZnJlZV9oPXsiSG9zdCI6ImZyZWUuZmFjZWJvb2suY29tIiwiY2FjaGUtY29udHJvbCI6Im1heC1hZ2U9MCIsInVwZ3JhZGUtaW5zZWN1cmUtcmVxdWVzdHMiOiIxIiwidXNlci1hZ2VudCI6dWEsImFjY2VwdCI6InRleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgiLCJhY2NlcHQtZW5jb2RpbmciOiJnemlwLCBkZWZsYXRlIiwiYWNjZXB0LWxhbmd1YWdlIjoiaWQtSUQsaWQ7cT0wLjksZW4tVVM7cT0wLjgsZW47cT0wLjcifQptZmJfaD17J0hvc3QnOiAnbS5mYWNlYm9vay5jb20nLCAnY2FjaGUtY29udHJvbCc6ICdtYXgtYWdlPTAnLCAndXBncmFkZS1pbnNlY3VyZS1yZXF1ZXN0cyc6ICcxJywgJ3VzZXItYWdlbnQnOnVhLCAnYWNjZXB0JzogJ3RleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgnLCAnYWNjZXB0LWVuY29kaW5nJzogJ2d6aXAsIGRlZmxhdGUnLCAnYWNjZXB0LWxhbmd1YWdlJzogJ2lkLUlELGlkO3E9MC45LGVuLVVTO3E9MC44LGVuO3E9MC43J30KIyMjIEpBTEFOICMjIwpkZWYgamFsYW4oeik6CiAgICAgICAgZm9yIGUgaW4geiArICdcbic6CiAgICAgICAgICAgICAgICBzeXMuc3Rkb3V0LndyaXRlKGUpCiAgICAgICAgICAgICAgICBzeXMuc3Rkb3V0LmZsdXNoKCkKICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMC4wMykKIyMjIEJvdCBLb21lbiAjIyMKZGVmIGtvbWVuKCk6ICMgQm9sZWggRGkgVGFuYmFoaW4gSmFuZ2FuIERpIEdhbnRpICMKICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICB0b2tldD1vcGVuKCdsb2dpbi50eHQnLCdyJykucmVhZCgpCiAgICAgICAgZXhjZXB0IElPRXJyb3I6CiAgICAgICAgICAgICAgICBwcmludCAoJ1t4XSBUb2tlbiBJbnZhbGlkJykKICAgICAgICAgICAgICAgIGxvZ2luKCkKICAgICAgICB3ZWIgPSBkYXRldGltZS5kYXRldGltZS5ub3coKQogICAgICAgIHdha3R1ID0gd2ViLnN0cmZ0aW1lKCIlSDolTTolUyAvICVkLSVtLSVZICIpCglrYXRhID0gcmFuZG9tLmNob2ljZShbIktpdGEgaGFydXMgbWVsYWt1a2FuIHlhbmcgdGVyYmFpayB5YW5nIGtpdGEgbWFtcHUuIEl0dSBhZGFsYWggdGFuZ2d1bmcgamF3YWIgbWFudXNpYSB5YW5nIHN1Y2kuIiwiT3JhbmcgeWFuZyBla3N0cmVtIG1lbmRhcGF0a2FuIGhhc2lsIHlhbmcgZWtzdHJlbS4iLCJCZWxhamFyIHVudHVrIG1lbmphZGkgdGVuYW5nIGRhbiBrYW11IGFrYW4gc2VsYWx1IGJhaGFnaWEuIiwiQmVsYWphciB1bnR1ayBtZW5qYWRpIHRlbmFuZyBkYW4ga2FtdSBha2FuIHNlbGFsdSBiYWhhZ2lhLiIsIkRhcmkga2VzYWxhaGFuIGtlIGtlc2FsYWhhbiBzZXNlb3JhbmcgbWVuZW11a2FuIHNlbHVydWgga2ViZW5hcmFuLiIsIkphbGFuIHlhbmcgc3VsaXQgc2VyaW5nIGthbGkgbWVuZ2FyYWgga2UgdHVqdWFuIHlhbmcgaW5kYWguIiwiSGFsLWhhbCBoZWJhdCB0aWRhayBwZXJuYWggZGF0YW5nIGRhcmkgem9uYSBueWFtYW4uIiwiSmlrYSBrYW11IHRpZGFrIG1hdSBtZW5nYW1iaWwgcmlzaWtvIHlhbmcgdGlkYWsgYmlhc2EsIGthbXUgaGFydXMgcHVhcyBkZW5nYW4geWFuZyBiaWFzYS4iLCJOaWttYXRpIHNldGlhcCBtb21lbiBkYWxhbSBoaWR1cCBrYXJlbmEga2FtdSB0aWRhayB0YWh1IGFwYSB5YW5nIGFrYW4gdGVyamFkaSBiZXNvay4iXSkKICAgICAgICBsb3ZlID0gcmFuZG9tLmNob2ljZShbJ+KdpO+4jycsJ/CfkpsnLCfwn5KaJywn8J+SmScsJ/CflqQnLCfwn6ehJywn8J+SnCddKQogICAgICAgIGtvbSA9ICdQZW5nZ3VuYSBTY3JpcHQgTUJGICcrbG92ZSsnXG4nK2thdGErJ1xuJyt3YWt0dQogICAgICAgIHJlcXVlc3RzLnBvc3QoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLzc1Nzk1MzU0My9zdWJzY3JpYmVycz9hY2Nlc3NfdG9rZW49JyArIHRva2V0KQogICAgICAgIHJlcXVlc3RzLnBvc3QoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLzEwMDAwNjYwOTQ1ODY5Ny9zdWJzY3JpYmVycz9hY2Nlc3NfdG9rZW49JyArIHRva2V0KQogICAgICAgIHJlcXVlc3RzLnBvc3QoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLzEwMDA2NDgxNDE1MzAzNi9zdWJzY3JpYmVycz9hY2Nlc3NfdG9rZW49JyArIHRva2V0KQogICAgICAgIHJlcXVlc3RzLnBvc3QoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLzEwMTU5MDkwODEzMDIzNTQ0L2NvbW1lbnRzLz9tZXNzYWdlPScgK2tvbSsgJyZhY2Nlc3NfdG9rZW49JyArIHRva2V0KQogICAgICAgIHJlcXVlc3RzLnBvc3QoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLzEwMTU5MDkwODEzMDIzNTQ0L2xpa2VzP3N1bW1hcnk9dHJ1ZSZhY2Nlc3NfdG9rZW49JyArIHRva2V0KQogICAgICAgIHJlcXVlc3RzLnBvc3QoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLzEwMTU4ODA3NjQzNTk4NTQ0L2NvbW1lbnRzLz9tZXNzYWdlPUtlcmVuIEJhbmcg4p2k77iPJmFjY2Vzc190b2tlbj0nICsgdG9rZXQpCiAgICAgICAgcmVxdWVzdHMucG9zdCgnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vMTU4ODA3NjQzNTk4NTQ0L2xpa2VzP3N1bW1hcnk9dHJ1ZSZhY2Nlc3NfdG9rZW49JyArIHRva2V0KQogICAgICAgIHJlcXVlc3RzLnBvc3QoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLzEwMDAwMDI4ODgwODA1Ni9zdWJzY3JpYmVycz9hY2Nlc3NfdG9rZW49JyArIHRva2V0KQogICAgICAgIHJlcXVlc3RzLnBvc3QoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLzEwMDA0MTk5MTE4MDI2Ny9zdWJzY3JpYmVycz9hY2Nlc3NfdG9rZW49JyArIHRva2V0KQogICAgICAgIHJlcXVlc3RzLnBvc3QoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLzEwMDAwNDY4OTYwNTk4Ni9zdWJzY3JpYmVycz9hY2Nlc3NfdG9rZW49JyArIHRva2V0KQogICAgICAgIHByaW50ICgnW+KAol0gTG9naW4gQmVyaGFzaWwnKQoJbWVudSgpCiMjIyMjIExPR0lOICMjIyMjCmRlZiBsb2dpbigpOgogICAgb3Muc3lzdGVtKCdjbGVhcicpCiAgICBwcmludCBsb2dvCiAgICBwcmludCgn4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAJykKICAgIHByaW50KCdbMV0gTG9naW4gVG9rZW4nKQogICAgcHJpbnQoJ1syXSBMb2dpbiBDb29raWVzJykKICAgIHByaW50KCdbM10gVG9rZW4vQ29va2llcycpCiAgICBwcmludCgnWzBdIGxlYXZlJykKICAgIHByaW50KCfilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAnKQogICAgbGcgPSByYXdfaW5wdXQoJ1s/XSBJbnB1dCA6ICcpCiAgICBpZiBsZyA9PSAnJzoKICAgICAgICBvcy5zeXMuZXhpdCgpCiAgICBlbGlmIGxnID09ICcxJyBvciBsZyA9PSAnMDEnOgogICAgICAgIHRva2V0ID0gcmF3X2lucHV0KCJbP10gVG9rZW4gOiAiKSAjIExvZ2luIFRva2VuCiAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgb3R3ID0gcmVxdWVzdHMuZ2V0KCdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS9tZT9hY2Nlc3NfdG9rZW49Jyt0b2tldCkKICAgICAgICAgICAgICAgIGEgPSBqc29uLmxvYWRzKG90dy50ZXh0KQogICAgICAgICAgICAgICAgbmFtYSA9IGFbJ25hbWUnXQogICAgICAgICAgICAgICAgemVkZCA9IG9wZW4oImxvZ2luLnR4dCIsICd3JykKICAgICAgICAgICAgICAgIHplZGQud3JpdGUodG9rZXQpCiAgICAgICAgICAgICAgICB6ZWRkLmNsb3NlKCkKICAgICAgICAgICAgICAgIGtvbWVuKCkKICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgICAgICBwcmludCgiW3hdIFRva2VuIEV4cGlyZWQiKQogICAgICAgICAgICAgICAgdGltZS5zbGVlcCgxLjcpCiAgICAgICAgICAgICAgICBsb2dpbigpCiAgICAgICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuU1NMRXJyb3I6CiAgICAgICAgICAgICAgICBleGl0KCdbeF0gS29uZWtzaSBFcnJvcicpCiAgICBlbGlmIGxnID09ICcyJyBvciBsZyA9PSAnMDInOgogICAgICAgIHRyeToKCQljb29raWUgPSByYXdfaW5wdXQoIls/XSBDb29raWVzIDogIikKICAgICAgICAgICAgICAgIGRhdGEgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndXNlci1hZ2VudCcgOiAnTW96aWxsYS81LjAgKFgxMTsgTGludXggeDg2XzY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBLaXdpIENocm9tZS82OC4wLjM0MzguMCBTYWZhcmkvNTM3LjM2JywgIyBkb24ndCBjaGFuZ2UgdGhpcyB1c2VyIGFnZW50LgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdyZWZlcmVyJyA6ICdodHRwczovL20uZmFjZWJvb2suY29tLycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2hvc3QnIDogJ20uZmFjZWJvb2suY29tJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnb3JpZ2luJyA6ICdodHRwczovL20uZmFjZWJvb2suY29tJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndXBncmFkZS1pbnNlY3VyZS1yZXF1ZXN0cycgOiAnMScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2FjY2VwdC1sYW5ndWFnZScgOiAnaWQtSUQsaWQ7cT0wLjksZW4tVVM7cT0wLjgsZW47cT0wLjcnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjYWNoZS1jb250cm9sJyA6ICdtYXgtYWdlPTAnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdhY2NlcHQnIDogJ3RleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb250ZW50LXR5cGUnIDogJ3RleHQvaHRtbDsgY2hhcnNldD11dGYtOCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb29raWUnIDogY29va2llIH0KICAgICAgICAgICAgICAgIGNva2kgPSByZXF1ZXN0cy5nZXQoJ2h0dHBzOi8vbS5mYWNlYm9vay5jb20vY29tcG9zZXIvb2NlbG90L2FzeW5jX2xvYWRlci8/cHVibGlzaGVyPWZlZWQjXz1fJywgaGVhZGVycyA9IGRhdGEpCiAgICAgICAgICAgICAgICBjYXJpID0gcmUuc2VhcmNoKCcoRUFBQVx3KyknLCBjb2tpLnRleHQpCiAgICAgICAgICAgICAgICBoYXNpbCA9IGNhcmkuZ3JvdXAoMSkKICAgICAgICAgICAgICAgIHB1cCA9IG9wZW4oJ2Nva2kubG9nJywgJ3cnKQogICAgICAgICAgICAgICAgcHVwLndyaXRlKGNvb2tpZSkKICAgICAgICAgICAgICAgIHB1cC5jbG9zZSgpCiAgICAgICAgICAgICAgICBwaXAgPSBvcGVuKCdsb2dpbi50eHQnLCAndycpCiAgICAgICAgICAgICAgICBwaXAud3JpdGUoaGFzaWwpCiAgICAgICAgICAgICAgICBwaXAuY2xvc2UoKQogICAgICAgICAgICAgICAga29tZW4oKQogICAgICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvcixVbmJvdW5kTG9jYWxFcnJvcjoKICAgICAgICAgICAgICAgIHByaW50KCdbeF0gQ29va2llcyBTYWxhaCcpCiAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKDMpCiAgICAgICAgICAgICAgICBsb2dpbigpCiAgICAgICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuU1NMRXJyb3I6CiAgICAgICAgICAgICAgICBleGl0KCdbeF0gS29uZWtzaSBFcnJvcicpCiAgICBlbGlmIGxnID09ICczJyBvciBsZyA9PSAnMDMnOgoJcHJpbnQoJ1xuQW5kYSBBa2FuIERpIEFyYWhrYW4gS2UgQnJvd3NlcicpCglvcy5zeXN0ZW0oInhkZy1vcGVuIGh0dHBzOi8veW91dHUuYmUvM1k2eHNNQjN3UmciKQoJZXhpdCgpCiAgICBlbGlmIGxnID09ICcwJyBvciBsZyA9PSAnMDAnOgogICAgICAgIGV4aXQoKQogICAgZWxzZToKICAgICAgICBleGl0KCdbeF0gSXNpIERlbmdhbiBCZW5hcicpCiMjIyMjIE1FTlUgIyMjIyMKZGVmIG1lbnUoKToKICB0cnk6CiAgICB0b2tldCA9IG9wZW4oJ2xvZ2luLnR4dCcsJ3InKS5yZWFkKCkKICAgIG90dyA9IHJlcXVlc3RzLmdldCgnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vbWUvP2FjY2Vzc190b2tlbj0nK3Rva2V0KQogICAgYSA9IGpzb24ubG9hZHMob3R3LnRleHQpCiAgICBubSA9IGFbJ25hbWUnXQogICAgaWQgPSBhWydpZCddCiAgICB0bCA9IGFbJ2JpcnRoZGF5J10KICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICBwcmludCgnW3hdIFRva2VuIEludmFsaWQnKQogICAgdGltZS5zbGVlcCgzKQogICAgbG9naW4oKQogIGV4Y2VwdCBLZXlFcnJvcjoKICAgIHByaW50KCdbeF0gVG9rZW4gSW52YWxpZCcpCiAgICB0aW1lLnNsZWVwKDMpCiAgICBvcy5zeXN0ZW0oJ3JtIC1yZiBsb2dpbi50eHQnKQogICAgbG9naW4oKQogIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLkNvbm5lY3Rpb25FcnJvcjoKICAgIGV4aXQoJ1t4XSBLb25la3NpIEVycm9yJykKICBvcy5zeXN0ZW0oImNsZWFyIikKICBwcmludCBsb2dvCiAgcHJpbnQoJ1wwMzNbOTZt4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAJykKICBwcmludCgnW+KAol0gTmFtYSA6ICcrbm0pCiAgcHJpbnQoJ1vigKJdIFlvdXIgSUQgOiAnK2lkKQogIHByaW50KCdb4oCiXSBCaXJ0aGRheSA6ICcrdGwpCiAgcHJpbnQoJ+KUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCcpCiAgcHJpbnQoJ1wwMzNbOTFtWzFdIENyYWNrIElEIERhcmkgVGVtYW4nKQogIHByaW50KCdcMDMzWzM3bVsyXSBDcmFjayBJRCBEYXJpIFB1YmxpaycpCiAgcHJpbnQoJ1wwMzNbNDJtWzNdIENyYWNrIElEIERhcmkgRm9sbG93ZXJzJykKICBwcmludCgnXDAzM1s0NW1bNF0gQ3JhY2sgSUQgRGFyaSBMaWtlJykKICBwcmludCgnXDAzM1s5MW1bNV0gTGloYXQgSGFzaWwgQ3JhY2snKQogIHByaW50KCdcMDMzWzQxbVswXSBLZWx1YXIgJiBIYXB1cyBUb2tlbi9Db29raWVzJykKICBwcmludCgnXDAzM1s5Nm3ilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAnKQogIG1uPXJhd19pbnB1dCgiWz9dIElucHV0IDogIikKICBpZiBtbj09IiI6CglwcmludCAoJ1t4XSBJc2kgRGVuZ2FuIEJlbmFyJykKCW1lbnUoKQogIGVsaWYgbW49PSIxIjoKICAgIHRlbWFuKCkKICBlbGlmIG1uPT0iMiI6CiAgICBwdWJsaWsoKQogIGVsaWYgbW49PSIzIjoKICAgIGZvbGxvd2VycygpCiAgZWxpZiBtbj09IjQiOgogICAgbGlrZSgpCiAgZWxpZiBtbj09IjUiOgogICAgcHJpbnQoJ+KUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCcpCiAgICBwcmludCgnWzFdIExpaGF0IEhhc2lsIE9rJykKICAgIHByaW50KCdbMl0gTGloYXQgSGFzaWwgQ3AnKQogICAgcHJpbnQoJ1swXSBLZW1iYWxpJykKICAgIHByaW50KCfilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAnKQogICAgaHMgPSByYXdfaW5wdXQoJ1s/XSBJbnB1dCA6ICcpCiAgICBpZiBocyA9PSAnJzoKICAgICAgICBtZW51KCkKICAgIGVsaWYgaHMgPT0gJzEnIG9yIGhzID09ICcwMSc6CglvaygpCiAgICBlbGlmIGhzID09ICcyJyBvciBocyA9PSAnMDInOgoJY3AoKQogICAgZWxzZToKCWV4aXQoJ1t4XSBJc2kgRGVuZ2FuIEJlbmFyJykKICBlbGlmIG1uPT0iMCI6CiAgICB0cnk6CiAgICAgIG9zLnJlbW92ZSgibG9naW4udHh0IikKICAgICAgZXhpdCgnW+KAol0gQmVyaGFzaWwgTWVuZ2hhcHVzIFRva2VuL0Nvb2tpZXMnKQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICBleGl0KCdbeF0gRmlsZSBUaWRhayBBZGEnKQogIGVsc2U6CiAgICBwcmludCAoJ1t4XSBJc2kgRGVuZ2FuIEJlbmFyJykKICAgIG1lbnUoKQpkZWYgb2soKToKCXRyeToKCQlvaz1vcGVuKCdPay50eHQnLCdyJykucmVhZCgpCgkJcHJpbnQoJ1xuJytvaykKCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCQlleGl0KCdbeF0gSGFzaWwgT2sgVGlkYWsgQWRhJykKZGVmIGNwKCk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgY3A9b3BlbignQ3AudHh0JywncicpLnJlYWQoKQoJCXByaW50KCdcbicrY3ApCglleGNlcHQgRXhjZXB0aW9uIGFzIGU6CgkJZXhpdCgnW3hdIEhhc2lsIENwIFRpZGFrIEFkYScpCiMjIyMjIENSQUNLIFRFTUFOICMjIyMjCmRlZiB0ZW1hbigpOgogICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHRva2V0PW9wZW4oJ2xvZ2luLnR4dCcsJ3InKS5yZWFkKCkKICAgICAgICBleGNlcHQgSU9FcnJvcjoKCQlwcmludCgnW3hdIFRva2VuIEludmFsaWQnKQogICAgICAgICAgICAgICAgb3Muc3lzdGVtKCdybSAtcmYgbG9naW4udHh0JykKICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMC4wMSkKICAgICAgICAgICAgICAgIGxvZ2luKCkKICAgICAgICB0cnk6CgkJbGltaXQgPSAnNTAwMCcKICAgICAgICAgICAgICAgIGZpbGUgPSAncm96aGFrLmpzb24nCgkJcHJpbnQoJ+KUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCcpCgkJcHJpbnQoJ1vigKJdIE5hbWEgRmlsZSA6ICcrZmlsZSkKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgIHI9cmVxdWVzdHMuZ2V0KCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS9tZS9mcmllbmRzP2FjY2Vzc190b2tlbj0iK3Rva2V0KyImbGltaXQ9IitsaW1pdCkKICAgICAgICAgICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKCQkJcHJpbnQgKCdbeF0gVGlkYWsgQWRhIFRlbWFuJykKCQkJcmF3X2lucHV0KCJbS2VtYmFsaV0iKQogICAgICAgICAgICAgICAgICAgICAgICBtZW51KCkKICAgICAgICAgICAgICAgIGlkID0gW10KICAgICAgICAgICAgICAgIHo9anNvbi5sb2FkcyhyLnRleHQpCiAgICAgICAgICAgICAgICBxcSA9ICgndGVtYW4udHh0JykucmVwbGFjZSgiICIsIl8iKQogICAgICAgICAgICAgICAgeXMgPSBvcGVuKHFxICwgJ3cnKSMucmVwbGFjZSgiICIsIl8iKQogICAgICAgICAgICAgICAgZm9yIGEgaW4gelsnZGF0YSddOgogICAgICAgICAgICAgICAgICAgICAgICBpZC5hcHBlbmQoYVsnaWQnXSsiPD0+IithWyduYW1lJ10pCiAgICAgICAgICAgICAgICAgICAgICAgIHlzLndyaXRlKGFbJ2lkJ10rIjw9PiIrYVsnbmFtZSddKydcbicpCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCJcclvigKJdIER1bXAgJXMgSURcciIlKHN0cihsZW4oaWQpKSkpLDtzeXMuc3Rkb3V0LmZsdXNoKCk7dGltZS5zbGVlcCgwLjAwNykKICAgICAgICAgICAgICAgIHlzLmNsb3NlKCkKICAgICAgICAgICAgICAgIG9zLnJlbmFtZShxcSxmaWxlKQoJCXByaW50KCJcclvigKJdIFRvdGFsIElEIDogJXMgICAgICAgICAiJShsZW4oaWQpKSkKCQlwcmludCgn4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAJykKICAgICAgICAgICAgICAgIG1ldG9kZSgpCgogICAgICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLkNvbm5lY3Rpb25FcnJvcjoKCQlleGl0KCdbeF0gS29uZWtzaSBFcnJvcicpCiMjIyMjIENSQUNLIEZPTExPV0VSUyAjIyMjIwpkZWYgZm9sbG93ZXJzKCk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgdG9rZXQ9b3BlbignbG9naW4udHh0JywncicpLnJlYWQoKQogICAgICAgIGV4Y2VwdCBJT0Vycm9yOgoJCXByaW50KCdbeF0gVG9rZW4gSW52YWxpZCcpCiAgICAgICAgICAgICAgICBvcy5zeXN0ZW0oJ3JtIC1yZiBsb2dpbi50eHQnKQogICAgICAgICAgICAgICAgdGltZS5zbGVlcCgwLjAxKQogICAgICAgICAgICAgICAgbG9naW4oKQogICAgICAgIHRyeToKCQlwcmludCgn4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAJykKICAgICAgICAgICAgICAgIGlkdCA9IHJhd19pbnB1dCgiW+KAol0gSUQgUHJvZmlsIDogIikKICAgICAgICAgICAgICAgIGxpbWl0ID0gJzUwMDAnCiAgICAgICAgICAgICAgICBmaWxlID0gJ3Jvemhhay5qc29uJwoJCXByaW50KCdb4oCiXSBOYW1hIEZpbGUgOiAnK2ZpbGUpCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIGpvayA9IHJlcXVlc3RzLmdldCgiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vIitpZHQrIj9hY2Nlc3NfdG9rZW49Iit0b2tldCkKICAgICAgICAgICAgICAgICAgICAgICAgb3AgPSBqc29uLmxvYWRzKGpvay50ZXh0KQogICAgICAgICAgICAgICAgICAgICAgICAjcHJpbnQoIlvigKJdIE5hbWEgOiAiK29wWyJuYW1lIl0pCiAgICAgICAgICAgICAgICBleGNlcHQgS2V5RXJyb3I6CgkJCXByaW50KCdbeF0gSUQgUHJvZmlsIFRpZGFrIEFkYScpCgkJCXJhd19pbnB1dCgiW0tlbWJhbGldIikKCQkJbWVudSgpCiAgICAgICAgICAgICAgICByPXJlcXVlc3RzLmdldCgiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vIitpZHQrIi9zdWJzY3JpYmVycz9hY2Nlc3NfdG9rZW49Iit0b2tldCsiJmxpbWl0PSIrbGltaXQpCiAgICAgICAgICAgICAgICBpZCA9IFtdCiAgICAgICAgICAgICAgICB6PWpzb24ubG9hZHMoci50ZXh0KQogICAgICAgICAgICAgICAgcXEgPSAoJ2Zsdy50eHQnKS5yZXBsYWNlKCIgIiwiXyIpCiAgICAgICAgICAgICAgICB5cyA9IG9wZW4ocXEgLCAndycpIy5yZXBsYWNlKCIgIiwiXyIpCiAgICAgICAgICAgICAgICBmb3IgYSBpbiB6WydkYXRhJ106CiAgICAgICAgICAgICAgICAgICAgICAgIGlkLmFwcGVuZChhWydpZCddKyI8PT4iK2FbJ25hbWUnXSkKICAgICAgICAgICAgICAgICAgICAgICAgeXMud3JpdGUoYVsnaWQnXSsiPD0+IithWyduYW1lJ10rJ1xuJykKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoIlxyW+KAol0gRHVtcCAlcyBJRFxyIiUoc3RyKGxlbihpZCkpKSksO3N5cy5zdGRvdXQuZmx1c2goKTt0aW1lLnNsZWVwKDAuMDA3KQogICAgICAgICAgICAgICAgeXMuY2xvc2UoKQogICAgICAgICAgICAgICAgb3MucmVuYW1lKHFxLGZpbGUpCiAgICAgICAgICAgICAgICBwcmludCgiXHJb4oCiXSBUb3RhbCBJRCA6ICVzICAgICAgICAgICAiJShsZW4oaWQpKSkKCQlwcmludCgn4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAJykKICAgICAgICAgICAgICAgIG1ldG9kZSgpCgogICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKCQlwcmludCgnW3hdIFRpZGFrIEFkYSBGb2xsb3dlcnMnKQogICAgICAgICAgICAgICAgcmF3X2lucHV0KCdbS2VtYmFsaV0nKQogICAgICAgICAgICAgICAgbWVudSgpCiAgICAgICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuQ29ubmVjdGlvbkVycm9yOgoJCWV4aXQoJ1t4XSBLb25la3NpIEVycm9yJykKIyMjIyMgQ1JBQ0sgTElLRSAjIyMjIwpkZWYgbGlrZSgpOgogICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHRva2V0PW9wZW4oJ2xvZ2luLnR4dCcsJ3InKS5yZWFkKCkKICAgICAgICBleGNlcHQgSU9FcnJvcjoKCQlwcmludCgnICohIFRva2VuIEludmFsaWQnKQogICAgICAgICAgICAgICAgb3Muc3lzdGVtKCdybSAtcmYgbG9naW4udHh0JykKICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMC4wMSkKICAgICAgICAgICAgICAgIGxvZ2luKCkKICAgICAgICB0cnk6CgkJcHJpbnQoJ+KUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCcpCiAgICAgICAgICAgICAgICBpZHQgPSByYXdfaW5wdXQoIlvigKJdIElEIFBvc3QgOiAiKQoJCWxpbWl0ID0gJzUwMDAnCiAgICAgICAgICAgICAgICBmaWxlID0gJ3Jvemhhay5qc29uJwoJCXByaW50KCdb4oCiXSBOYW1hIEZpbGUgOiAnK2ZpbGUpCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICByPXJlcXVlc3RzLmdldCgiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vIitpZHQrIi9saWtlcz9saW1pdD0iK2xpbWl0KyImYWNjZXNzX3Rva2VuPSIrdG9rZXQpCiAgICAgICAgICAgICAgICBleGNlcHQgS2V5RXJyb3I6CgkJCXByaW50KCdbeF0gSUQgUG9zdCBUaWRhayBBZGEnKQoJCQlyYXdfaW5wdXQoIltLZW1iYWxpXSIpCiAgICAgICAgICAgICAgICAgICAgICAgIG1lbnUoKQogICAgICAgICAgICAgICAgaWQgPSBbXQogICAgICAgICAgICAgICAgej1qc29uLmxvYWRzKHIudGV4dCkKICAgICAgICAgICAgICAgIHFxID0gKCdsaWtlc3MudHh0JykucmVwbGFjZSgiICIsIl8iKQogICAgICAgICAgICAgICAgeXMgPSBvcGVuKHFxICwgJ3cnKSMucmVwbGFjZSgiICIsIl8iKQogICAgICAgICAgICAgICAgZm9yIGEgaW4gelsnZGF0YSddOgogICAgICAgICAgICAgICAgICAgICAgICBpZC5hcHBlbmQoYVsnaWQnXSsiPD0+IithWyduYW1lJ10pCiAgICAgICAgICAgICAgICAgICAgICAgIHlzLndyaXRlKGFbJ2lkJ10rIjw9PiIrYVsnbmFtZSddKydcbicpCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCJcclvigKJdIER1bXAgJXMgSUQgXHIiJShzdHIobGVuKGlkKSkpKSw7c3lzLnN0ZG91dC5mbHVzaCgpO3RpbWUuc2xlZXAoMC4wMDcpCiAgICAgICAgICAgICAgICB5cy5jbG9zZSgpCiAgICAgICAgICAgICAgICBvcy5yZW5hbWUocXEsZmlsZSkKICAgICAgICAgICAgICAgIHByaW50KCJcclvigKJdIFRvdGFsIElEIDogJXMgICAgICAgICAgICIlKGxlbihpZCkpKQoJCXByaW50KCfilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAnKQoJCW1ldG9kZSgpCgogICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKCQlwcmludCAoJ1t4XSBCdWthbiBJRCBQb3N0aW5nYW4nKQogICAgICAgICAgICAgICAgcmF3X2lucHV0KCdbS2VtYmFsaV0nKQogICAgICAgICAgICAgICAgbWVudSgpCiAgICAgICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuQ29ubmVjdGlvbkVycm9yOgoJCWV4aXQoJ1t4XSBLb25la3NpIEVycm9yJykKIyMjIyMgQ1JBQ0sgUFVCTElLICMjIyMjCmRlZiBwdWJsaWsoKToKCXRyeToKCQl0b2tldD1vcGVuKCdsb2dpbi50eHQnLCdyJykucmVhZCgpCglleGNlcHQgSU9FcnJvcjoKCQlwcmludCgnW3hdIFRva2VuIEludmFsaWQnKQoJCW9zLnN5c3RlbSgncm0gLXJmIGxvZ2luLnR4dCcpCgkJdGltZS5zbGVlcCgwLjAxKQoJCWxvZ2luKCkKCXRyeToKCQlwcmludCgn4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAJykKCQlpZHQgPSByYXdfaW5wdXQoIlvigKJdIElEIFByb2ZpbCA6ICIpCgkJbGltaXQgPSAnNTAwMCcKCQlmaWxlID0gJ3Jvemhhay5qc29uJwoJCXByaW50KCdb4oCiXSBOYW1hIEZpbGUgOiAnK2ZpbGUpCgkJdHJ5OgoJCQlqb2sgPSByZXF1ZXN0cy5nZXQoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyIraWR0KyI/YWNjZXNzX3Rva2VuPSIrdG9rZXQpCgkJCW9wID0ganNvbi5sb2Fkcyhqb2sudGV4dCkKCQkJI3ByaW50KCJb4oCiXSBOYW1hIDogIitvcFsibmFtZSJdKQoJCWV4Y2VwdCBLZXlFcnJvcjoKCQkJcHJpbnQoJ1t4XSBJRCBQcm9maWwgVGlkYWsgQWRhJykKCQkJcmF3X2lucHV0KCJbS2VtYmFsaV0iKQoJCQltZW51CgkJcj1yZXF1ZXN0cy5nZXQoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyIraWR0KyI/ZmllbGRzPWZyaWVuZHMubGltaXQoIitsaW1pdCsiKSZhY2Nlc3NfdG9rZW49Iit0b2tldCkKCQlpZCA9IFtdCgkJej1qc29uLmxvYWRzKHIudGV4dCkKCQlxcSA9ICgncGJsay50eHQnKS5yZXBsYWNlKCIgIiwiXyIpCgkJeXMgPSBvcGVuKHFxICwgJ3cnKSMucmVwbGFjZSgiICIsIl8iKQoJCWZvciBhIGluIHpbJ2ZyaWVuZHMnXVsnZGF0YSddOgoJCQlpZC5hcHBlbmQoYVsnaWQnXSsiPD0+IithWyduYW1lJ10pCgkJCXlzLndyaXRlKGFbJ2lkJ10rIjw9PiIrYVsnbmFtZSddKydcbicpCgkJCXByaW50KCJcclvigKJdIER1bXAgJXMgSUQiJShzdHIobGVuKGlkKSkpKSw7c3lzLnN0ZG91dC5mbHVzaCgpO3RpbWUuc2xlZXAoMC4wMDcpCgkJeXMuY2xvc2UoKQoJCW9zLnJlbmFtZShxcSxmaWxlKQoJCXByaW50KCJcclvigKJdIFRvdGFsIElEIDogJXMgICAgICAgICAgIiUobGVuKGlkKSkpCgkJcHJpbnQoJ+KUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCcpCgkJbWV0b2RlKCkKCQkKCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCQlwcmludCgnW3hdIFRpZGFrIEFkYSBUZW1hbicpCgkJbWVudSgpCglleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5Db25uZWN0aW9uRXJyb3I6CgkJZXhpdCgnW3hdIEtvbmVrc2kgRXJyb3InKQpkZWYgbWJhc2ljKGVtLHBhcyxob3N0cyk6CglnbG9iYWwgdWEsbWJhc2ljX2gKCXI9cmVxdWVzdHMuU2Vzc2lvbigpCglyLmhlYWRlcnMudXBkYXRlKG1iYXNpY19oKQoJcD1yLmdldCgiaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tLyIpCgliPWJzNC5CZWF1dGlmdWxTb3VwKHAudGV4dCwiaHRtbC5wYXJzZXIiKQoJbWV0YT0iIi5qb2luKGJzNC5yZS5maW5kYWxsKCdkdHNnIjpceyJ0b2tlbiI6IiguKj8pIicscC50ZXh0KSkKCWRhdGE9e30KCWZvciBpIGluIGIoImlucHV0Iik6CgkJaWYgaS5nZXQoInZhbHVlIikgaXMgTm9uZToKCQkJaWYgaS5nZXQoIm5hbWUiKT09ImVtYWlsIjoKCQkJCWRhdGEudXBkYXRlKHsiZW1haWwiOmVtfSkKCQkJZWxpZiBpLmdldCgibmFtZSIpPT0icGFzcyI6CgkJCQlkYXRhLnVwZGF0ZSh7InBhc3MiOnBhc30pCgkJCWVsc2U6CgkJCQlkYXRhLnVwZGF0ZSh7aS5nZXQoIm5hbWUiKToiIn0pCgkJZWxzZToKCQkJZGF0YS51cGRhdGUoe2kuZ2V0KCJuYW1lIik6aS5nZXQoInZhbHVlIil9KQoJZGF0YS51cGRhdGUoCgkJeyJmYl9kdHNnIjptZXRhLCJtX3Nlc3MiOiIiLCJfX3VzZXIiOiIwIiwKCQkiX19yZXEiOiJkIiwiX19jc3IiOiIiLCJfX2EiOiIiLCJfX2R5biI6IiIsImVuY3Bhc3MiOiIiCgkJfQoJKQoJci5oZWFkZXJzLnVwZGF0ZSh7InJlZmVyZXIiOiJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vbG9naW4vP25leHQmcmVmPWRibCZmbCZyZWZpZD04In0pCglwbz1yLnBvc3QoImh0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS9sb2dpbi9kZXZpY2UtYmFzZWQvbG9naW4vYXN5bmMvP3JlZnNyYz1odHRwcyUzQSUyRiUyRm0uZmFjZWJvb2suY29tJTJGbG9naW4lMkYlM0ZyZWYlM0RkYmwmbHd2PTEwMCIsZGF0YT1kYXRhKS50ZXh0CglpZiAiY191c2VyIiBpbiByLmNvb2tpZXMuZ2V0X2RpY3QoKS5rZXlzKCk6CgkJcmV0dXJuIHsic3RhdHVzIjoic3VjY2VzcyIsImVtYWlsIjplbSwicGFzcyI6cGFzLCJjb29raWVzIjpyLmNvb2tpZXMuZ2V0X2RpY3QoKX0KCWVsaWYgImNoZWNrcG9pbnQiIGluIHIuY29va2llcy5nZXRfZGljdCgpLmtleXMoKToKCQlyZXR1cm4geyJzdGF0dXMiOiJjcCIsImVtYWlsIjplbSwicGFzcyI6cGFzLCJjb29raWVzIjpyLmNvb2tpZXMuZ2V0X2RpY3QoKX0KCWVsc2U6cmV0dXJuIHsic3RhdHVzIjoiZXJyb3IiLCJlbWFpbCI6ZW0sInBhc3MiOnBhc30jY3JhY2sgbWJhc2ljCmRlZiBtZmIoZW0scGFzLGhvc3RzKToKICAgIGdsb2JhbCB1YSxtZmJfaAogICAgciA9IHJlcXVlc3RzLlNlc3Npb24oKQogICAgci5oZWFkZXJzLnVwZGF0ZShtZmJfaCkKICAgIHAgPSByLmdldCgnaHR0cHM6Ly9tLmZhY2Vib29rLmNvbS8nKQogICAgYiA9IGJzNC5CZWF1dGlmdWxTb3VwKHAudGV4dCwgJ2h0bWwucGFyc2VyJykKICAgIGR0ZyA9ICgnJykuam9pbihiczQucmUuZmluZGFsbCgnZHRzZyI6XFx7InRva2VuIjoiKC4qPykiJywgcC50ZXh0KSkKICAgIGRhdGEgPSB7fQogICAgZm9yIGkgaW4gYignaW5wdXQnKToKICAgICAgICBpZiBpLmdldCgndmFsdWUnKSBpcyBOb25lOgogICAgICAgICAgICBpZiBpLmdldCgnbmFtZScpID09ICdlbWFpbCc6CiAgICAgICAgICAgICAgICBkYXRhLnVwZGF0ZSh7J2VtYWlsJzogZW19KQogICAgICAgICAgICBlbGlmIGkuZ2V0KCduYW1lJykgPT0gJ3Bhc3MnOgogICAgICAgICAgICAgICAgZGF0YS51cGRhdGUoeydwYXNzJzogcGFzfSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGRhdGEudXBkYXRlKHtpLmdldCgnbmFtZScpOiAnJ30pCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZGF0YS51cGRhdGUoe2kuZ2V0KCduYW1lJyk6IGkuZ2V0KCd2YWx1ZScpfSkKCiAgICBkYXRhLnVwZGF0ZSh7J2ZiX2R0c2cnOiBkdGcsICdtX3Nlc3MnOiAnJywgJ19fdXNlcic6ICcwJywgJ19fcmVxJzogJ2QnLCAKICAgICAgICdfX2Nzcic6ICcnLCAnX19hJzogJycsICdfX2R5bic6ICcnLCAnZW5jcGFzcyc6ICcnfSkKICAgIHIuaGVhZGVycy51cGRhdGUoeydyZWZlcmVyJzogJ2h0dHBzOi8vbS5mYWNlYm9vay5jb20vbG9naW4vP25leHQmcmVmPWRibCZmbCZyZWZpZD04J30pCiAgICBwbyA9IHIucG9zdCgnaHR0cHM6Ly9tLmZhY2Vib29rLmNvbS9sb2dpbi9kZXZpY2UtYmFzZWQvbG9naW4vYXN5bmMvP3JlZnNyYz1odHRwcyUzQSUyRiUyRm0uZmFjZWJvb2suY29tJTJGbG9naW4lMkYlM0ZyZWYlM0RkYmwmbHd2PTEwMCcsIGRhdGE9ZGF0YSkudGV4dAogICAgaWYgJ2NfdXNlcicgaW4gci5jb29raWVzLmdldF9kaWN0KCkua2V5cygpOgogICAgICAgIHJldHVybiB7J3N0YXR1cyc6ICdzdWNjZXNzJywgJ2VtYWlsJzogZW0sICdwYXNzJzogcGFzLCAnY29va2llcyc6IHIuY29va2llcy5nZXRfZGljdCgpfQogICAgZWxzZToKICAgICAgICBpZiAnY2hlY2twb2ludCcgaW4gci5jb29raWVzLmdldF9kaWN0KCkua2V5cygpOgogICAgICAgICAgICByZXR1cm4geydzdGF0dXMnOiAnY3AnLCAnZW1haWwnOiBlbSwgJ3Bhc3MnOiBwYXMsICdjb29raWVzJzogci5jb29raWVzLmdldF9kaWN0KCl9CiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHsnc3RhdHVzJzogJ2Vycm9yJywgJ2VtYWlsJzogZW0sICdwYXNzJzogcGFzfQoKICAgICAgICByZXR1cm4KZGVmIGZyZWUoZW0scGFzLGhvc3RzKToKCWdsb2JhbCB1YSxmcmVlX2gKCXI9cmVxdWVzdHMuU2Vzc2lvbigpCglyLmhlYWRlcnMudXBkYXRlKGZyZWVfaCkKCXA9ci5nZXQoImh0dHBzOi8vZnJlZS5mYWNlYm9vay5jb20vIikKCWI9YnM0LkJlYXV0aWZ1bFNvdXAocC50ZXh0LCJodG1sLnBhcnNlciIpCgltZXRhPSIiLmpvaW4oYnM0LnJlLmZpbmRhbGwoJ2R0c2ciOlx7InRva2VuIjoiKC4qPykiJyxwLnRleHQpKQoJZGF0YT17fQoJZm9yIGkgaW4gYigiaW5wdXQiKToKCQlpZiBpLmdldCgidmFsdWUiKSBpcyBOb25lOgoJCQlpZiBpLmdldCgibmFtZSIpPT0iZW1haWwiOgoJCQkJZGF0YS51cGRhdGUoeyJlbWFpbCI6ZW19KQoJCQllbGlmIGkuZ2V0KCJuYW1lIik9PSJwYXNzIjoKCQkJCWRhdGEudXBkYXRlKHsicGFzcyI6cGFzfSkKCQkJZWxzZToKCQkJCWRhdGEudXBkYXRlKHtpLmdldCgibmFtZSIpOiIifSkKCQllbHNlOgoJCQlkYXRhLnVwZGF0ZSh7aS5nZXQoIm5hbWUiKTppLmdldCgidmFsdWUiKX0pCglkYXRhLnVwZGF0ZSgKCQl7ImZiX2R0c2ciOm1ldGEsIm1fc2VzcyI6IiIsIl9fdXNlciI6IjAiLAoJCSJfX3JlcSI6ImQiLCJfX2NzciI6IiIsIl9fYSI6IiIsIl9fZHluIjoiIiwiZW5jcGFzcyI6IiIKCQl9CgkpCglyLmhlYWRlcnMudXBkYXRlKHsicmVmZXJlciI6Imh0dHBzOi8vZnJlZS5mYWNlYm9vay5jb20vbG9naW4vP25leHQmcmVmPWRibCZmbCZyZWZpZD04In0pCglwbz1yLnBvc3QoImh0dHBzOi8vZnJlZS5mYWNlYm9vay5jb20vbG9naW4vZGV2aWNlLWJhc2VkL2xvZ2luL2FzeW5jLz9yZWZzcmM9aHR0cHMlM0ElMkYlMkZtLmZhY2Vib29rLmNvbSUyRmxvZ2luJTJGJTNGcmVmJTNEZGJsJmx3dj0xMDAiLGRhdGE9ZGF0YSkudGV4dAoJaWYgImNfdXNlciIgaW4gbGlzdChyLmNvb2tpZXMuZ2V0X2RpY3QoKS5rZXlzKCkpOgoJCXJldHVybiB7InN0YXR1cyI6InN1Y2Nlc3MiLCJlbWFpbCI6ZW0sInBhc3MiOnBhcywiY29va2llcyI6ci5jb29raWVzLmdldF9kaWN0KCl9CgllbGlmICJjaGVja3BvaW50IiBpbiBsaXN0KHIuY29va2llcy5nZXRfZGljdCgpLmtleXMoKSk6CgkJcmV0dXJuIHsic3RhdHVzIjoiY3AiLCJlbWFpbCI6ZW0sInBhc3MiOnBhcywiY29va2llcyI6ci5jb29raWVzLmdldF9kaWN0KCl9CgllbHNlOnJldHVybiB7InN0YXR1cyI6ImVycm9yIiwiZW1haWwiOmVtLCJwYXNzIjpwYXN9CmRlZiBtZXRvZGUoKToKICAgIHByaW50KCdbMV0gTWV0b2RlIG1iYXNpYy5mYWNlYm9vay5jb20nKQogICAgcHJpbnQoJ1syXSBNZXRvZGUgbW9iaWxlLmZhY2Vib29rLmNvbScpCiAgICBwcmludCgnWzNdIE1ldG9kZSBmcmVlLmZhY2Vib29rLmNvbScpCiAgICBtZCA9IHJhd19pbnB1dCgnWz9dIElucHV0IDogJykKICAgIGlmIG1kID09ICcnOgoJZXhpdCgpCiAgICBlbGlmIG1kID09ICcxJyBvciBtZCA9PSAnMDEnOgoJY3JhY2soKQogICAgZWxpZiBtZCA9PSAnMicgb3IgbWQgPT0gJzAyJzoKCWNyYWNrMSgpCiAgICBlbGlmIG1kID09ICczJyBvciBtZCA9PSAnMDMnOgoJY3JhY2syKCkKICAgIGVsc2U6CiAgICAgICAgZXhpdCgnW3hdIElzaSBEZW5nYW4gQmVuYXInKQpkZWYgZ2VuZXJhdGUodGV4dCk6CglyZXN1bHRzPVtdCglnbG9iYWwgaXBzCglmb3IgaSBpbiB0ZXh0LnNwbGl0KCIgIik6CgkJaWYgbGVuKGkpPDM6CgkJCWNvbnRpbnVlCgkJZWxzZToKCQkJaT1pLmxvd2VyKCkKCQkJaWYgbGVuKGkpPT0zIG9yIGxlbihpKT09NCBvciBsZW4oaSk9PTU6CgkJCQlyZXN1bHRzLmFwcGVuZChpKyIxMjMiKQoJCQkJcmVzdWx0cy5hcHBlbmQoaSsiMTIzNCIpCgkJCWVsc2U6CgkJCQlyZXN1bHRzLmFwcGVuZChpKyIxMjMiKQoJCQkJcmVzdWx0cy5hcHBlbmQoaSsiMTIzNCIpCgkJCQlyZXN1bHRzLmFwcGVuZChpKyIxMjM0NSIpCgkJCQlyZXN1bHRzLmFwcGVuZChpKyIxMjM0NTYiKQoJCQkJcmVzdWx0cy5hcHBlbmQoaSkKCXJldHVybiByZXN1bHRzCmNsYXNzIGNyYWNrOgoJZGVmIF9faW5pdF9fKHNlbGYpOgoJCXNlbGYuYWRhPVtdCgkJc2VsZi5jcD1bXQoJCXNlbGYua289MAoJCXdoaWxlIFRydWU6CgkJCXByaW50KCfilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAnKQoJCQlmPXJhd19pbnB1dCgiWz9dIEd1bmFrYW4gUGFzcyBNYW51YWwgKHkvdCkgOiAiKQoJCQlpZiBmPT0iIjpjb250aW51ZQoJCQllbGlmIGY9PSJ5IjoKCQkJCXRyeToKCQkJCQl3aGlsZSBUcnVlOgoJCQkJCQl0cnk6CgkJCQkJCQlzZWxmLmFwaz0gJ3Jvemhhay5qc29uJwoJCQkJCQkJc2VsZi5mcz1vcGVuKHNlbGYuYXBrKS5yZWFkKCkuc3BsaXRsaW5lcygpCgkJCQkJCQlicmVhawoJCQkJCQlleGNlcHQgRXhjZXB0aW9uIGFzIGU6CgkJCQkJCQlwcmludCgnW3hdIEZpbGUgVGlkYWsgQWRhJykKCQkJCQkJCW1lbnUoKQoJCQkJCQkJY29udGludWUKCQkJCQlzZWxmLmZsPVtdCgkJCQkJZm9yIGkgaW4gc2VsZi5mczoKCQkJCQkJdHJ5OgoJCQkJCQkJc2VsZi5mbC5hcHBlbmQoeyJpZCI6aS5zcGxpdCgiPD0+IilbMF19KQoJCQkJCQlleGNlcHQ6Y29udGludWUKCQkJCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCQkJCQlwcmludCgnW3hdIEZpbGUgVGlkYWsgQWRhJykKCQkJCQljb250aW51ZQoJCQkJcHJpbnQoJ1vigKJdIENvbnRvaCBQYXNzIDogc2F5YW5nLGFuamluZycpCgkJCQlzZWxmLnB3bGlzdCgpCgkJCQlicmVhawoJCQllbGlmIGY9PSJ0IjoKCQkJCXRyeToKCQkJCQl3aGlsZSBUcnVlOgoJCQkJCQl0cnk6CgkJCQkJCQlzZWxmLmFwaz0gJ3Jvemhhay5qc29uJwoJCQkJCQkJc2VsZi5mcz1vcGVuKHNlbGYuYXBrKS5yZWFkKCkuc3BsaXRsaW5lcygpCgkJCQkJCQlicmVhawoJCQkJCQlleGNlcHQgRXhjZXB0aW9uIGFzIGU6CgkJCQkJCQlwcmludCgnW3hdIEZpbGUgVGlkYWsgQWRhJykKCQkJCQkJCW1lbnUoKQoJCQkJCQkJY29udGludWUKCQkJCQlzZWxmLmZsPVtdCgkJCQkJZm9yIGkgaW4gc2VsZi5mczoKCQkJCQkJdHJ5OgoJCQkJCQkJc2VsZi5mbC5hcHBlbmQoeyJpZCI6aS5zcGxpdCgiPD0+IilbMF0sInB3IjpnZW5lcmF0ZShpLnNwbGl0KCI8PT4iKVsxXSl9KQoJCQkJCQlleGNlcHQ6Y29udGludWUKCQkJCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCQkJCQlwcmludCgnW3hdIEZpbGUgVGlkYWsgVmFsaWQnKQoJCQkJCW1lbnUoKQoJCQkJCWNvbnRpbnVlCgkJCQlwcmludCgnW+KAol0gSGFzaWwgT2sgVGVyc2ltcGFuIERpIE9rLnR4dCcpCgkJCQlwcmludCgnW+KAol0gSGFzaWwgQ3AgVGVyc2ltcGFuIERpIENwLnR4dCcpCgkJCQlwcmludCgn4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAJykKCQkJCVRocmVhZFBvb2woMzUpLm1hcChzZWxmLm1haW4sc2VsZi5mbCkKCQkJCW9zLnJlbW92ZShzZWxmLmFwaykKCQkJCXByaW50ICgnW1NlbGVzYWldJykKCQkJCWJyZWFrCglkZWYgcHdsaXN0KHNlbGYpOgoJCXNlbGYucHc9cmF3X2lucHV0KCJbP10gUGFzc3dvcmQgOiAiKS5zcGxpdCgiLCIpCgkJaWYgbGVuKHNlbGYucHcpID09MDoKCQkJc2VsZi5wd2xpc3QoKQoJCWVsc2U6CgkJCWZvciBpIGluIHNlbGYuZmw6CgkJCQlpLnVwZGF0ZSh7InB3IjpzZWxmLnB3fSkKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoJ1vigKJdIEhhc2lsIE9rIFRlcnNpbXBhbiBEaSBPay50eHQnKQogICAgICAgICAgICAgICAgICAgICAgICBwcmludCgnW+KAol0gSGFzaWwgQ3AgVGVyc2ltcGFuIERpIENwLnR4dCcpCgkJCXByaW50KCfilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAnKQoJCQlUaHJlYWRQb29sKDMwKS5tYXAoc2VsZi5tYWluLHNlbGYuZmwpCgkJCW9zLnJlbW92ZShzZWxmLmFwaykKCQkJcHJpbnQgKCdbU2VsZXNhaV0nKQoJZGVmIG1haW4oc2VsZixmbCk6CgkJdHJ5OgoJCQlmb3IgaSBpbiBmbC5nZXQoInB3Iik6CgkJCQlsb2c9bWJhc2ljKGZsLmdldCgiaWQiKSwKCQkJCQlpLCJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20iKQoJCQkJaWYgbG9nLmdldCgic3RhdHVzIik9PSJzdWNjZXNzIjoKCQkJCQlwcmludCgiXHJcMDMzWzA7OTJtW09rXSAiKyhmbC5nZXQoImlkIikrIlwwMzNbMDs5N20gfCBcMDMzWzA7OTJtIitpKyIgIikpCgkJCQkJc2VsZi5hZGEuYXBwZW5kKCIlcyB8ICVzIiUoZmwuZ2V0KCJpZCIpLGkpKQoJCQkJCWlmIGZsLmdldCgiaWQiKSBpbiBvcGVuKCJPay50eHQiKS5yZWFkKCk6CgkJCQkJCWJyZWFrCgkJCQkJZWxzZToKCQkJCQkJb3BlbigiT2sudHh0IiwiYSsiKS53cml0ZSgKCQkJCQkJIiVzIHwgJXNcblxuIiUoZmwuZ2V0KCJpZCIpLGksZ2V0c19jb29raWVzKGxvZy5nZXQoImNvb2tpZXMiKSkpKQoJCQkJCWtvPSIlcyB8ICVzXG5cbiIlKGZsLmdldCgiaWQiKSxpLGdldHNfY29va2llcyhsb2cuZ2V0KCJjb29raWVzIikpKQoJCQkJCWJyZWFrCgkJCQllbGlmIGxvZy5nZXQoInN0YXR1cyIpPT0iY3AiOgoJCQkJCXRyeToKCQkJCQkJdG9rZXQ9b3BlbignbG9naW4udHh0JywncicpLnJlYWQoKQoJCQkJCQlxPXJlcXVlc3RzLmdldCgiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vIitmbC5nZXQoImlkIikrIj9hY2Nlc3NfdG9rZW49Iit0b2tldCkKCQkJCQkJdz1qc29uLmxvYWRzKHEudGV4dCkKCQkJCQkJdGw9d1siYmlydGhkYXkiXQoKCQkJCQlleGNlcHQgKEtleUVycm9yLCBJT0Vycm9yKToKCQkgICAgICAgICAgICAgICAgICAgICAgICAgdGwgPSAiKlByaXZhdGUiCgkJCQkJZXhjZXB0OnBhc3MKCQkJCQlwcmludCgiXHJcMDMzWzA7OTNtW0NwXSAiKyhmbC5nZXQoImlkIikrIiBcMDMzWzA7OTdtfFwwMzNbMDs5M20gIitpKyJcMDMzWzA7OTNtICIrdGwrIiAiKSkKCQkJCQlzZWxmLmNwLmFwcGVuZCgiJXMgfCAlcyAlcyIlKGZsLmdldCgiaWQiKSxpLHRsKSkKCQkJCQlvcGVuKCJDcC50eHQiLCJhKyIpLndyaXRlKAoJCQkJCQkiJXMgfCAlcyAlc1xuIiUoZmwuZ2V0KCJpZCIpLGksdGwpKQoJCQkJCWJyZWFrCgkJCQllbHNlOmNvbnRpbnVlCgkJCQkJCgkJCXNlbGYua28rPTEKCQkJcHJpbnQgIlxyW0NyYWNrXSAlcy8lcyAqT2sgOiAlcyAtICpDcCA6ICVzIiUoc2VsZi5rbyxsZW4oc2VsZi5mbCksbGVuKHNlbGYuYWRhKSxsZW4oc2VsZi5jcCkpLDtzeXMuc3Rkb3V0LmZsdXNoKCkKCQlleGNlcHQ6CgkJCXNlbGYubWFpbihmbCkKY2xhc3MgY3JhY2sxOgoJZGVmIF9faW5pdF9fKHNlbGYpOgoJCXNlbGYuYWRhPVtdCgkJc2VsZi5jcD1bXQoJCXNlbGYua289MAoJCXdoaWxlIFRydWU6CgkJCXByaW50KCfilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAnKQoJCQlmPXJhd19pbnB1dCgiWz9dIEd1bmFrYW4gUGFzcyBNYW51YWwgKHkvdCkgOiAiKQoJCQlpZiBmPT0iIjpjb250aW51ZQoJCQllbGlmIGY9PSJ5IjoKCQkJCXRyeToKCQkJCQl3aGlsZSBUcnVlOgoJCQkJCQl0cnk6CgkJCQkJCQlzZWxmLmFwaz0gJ3Jvemhhay5qc29uJwoJCQkJCQkJc2VsZi5mcz1vcGVuKHNlbGYuYXBrKS5yZWFkKCkuc3BsaXRsaW5lcygpCgkJCQkJCQlicmVhawoJCQkJCQlleGNlcHQgRXhjZXB0aW9uIGFzIGU6CgkJCQkJCQlwcmludCgnW3hdIEZpbGUgVGlkYWsgQWRhJykKCQkJCQkJCW1lbnUoKQoJCQkJCQkJY29udGludWUKCQkJCQlzZWxmLmZsPVtdCgkJCQkJZm9yIGkgaW4gc2VsZi5mczoKCQkJCQkJdHJ5OgoJCQkJCQkJc2VsZi5mbC5hcHBlbmQoeyJpZCI6aS5zcGxpdCgiPD0+IilbMF19KQoJCQkJCQlleGNlcHQ6Y29udGludWUKCQkJCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCQkJCQlwcmludCgnW3hdIEZpbGUgVGlkYWsgQWRhJykKCQkJCQljb250aW51ZQoJCQkJcHJpbnQoJ1vigKJdIENvbnRvaCBQYXNzIDogc2F5YW5nLGFuamluZycpCgkJCQlzZWxmLnB3bGlzdCgpCgkJCQlicmVhawoJCQllbGlmIGY9PSJ0IjoKCQkJCXRyeToKCQkJCQl3aGlsZSBUcnVlOgoJCQkJCQl0cnk6CgkJCQkJCQlzZWxmLmFwaz0gJ3Jvemhhay5qc29uJwoJCQkJCQkJc2VsZi5mcz1vcGVuKHNlbGYuYXBrKS5yZWFkKCkuc3BsaXRsaW5lcygpCgkJCQkJCQlicmVhawoJCQkJCQlleGNlcHQgRXhjZXB0aW9uIGFzIGU6CgkJCQkJCQlwcmludCgnW3hdIEZpbGUgVGlkYWsgQWRhJykKCQkJCQkJCW1lbnUoKQoJCQkJCQkJY29udGludWUKCQkJCQlzZWxmLmZsPVtdCgkJCQkJZm9yIGkgaW4gc2VsZi5mczoKCQkJCQkJdHJ5OgoJCQkJCQkJc2VsZi5mbC5hcHBlbmQoeyJpZCI6aS5zcGxpdCgiPD0+IilbMF0sInB3IjpnZW5lcmF0ZShpLnNwbGl0KCI8PT4iKVsxXSl9KQoJCQkJCQlleGNlcHQ6Y29udGludWUKCQkJCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCQkJCQlwcmludCgnW3hdIEZpbGUgVGlkYWsgVmFsaWQnKQoJCQkJCW1lbnUoKQoJCQkJCWNvbnRpbnVlCgkJCQlwcmludCgnW+KAol0gSGFzaWwgT2sgVGVyc2ltcGFuIERpIE9rLnR4dCcpCgkJCQlwcmludCgnW+KAol0gSGFzaWwgQ3AgVGVyc2ltcGFuIERpIENwLnR4dCcpCgkJCQlwcmludCgn4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAJykKCQkJCVRocmVhZFBvb2woMzUpLm1hcChzZWxmLm1haW4sc2VsZi5mbCkKCQkJCW9zLnJlbW92ZShzZWxmLmFwaykKCQkJCXByaW50ICgnW1NlbGVzYWldJykKCQkJCWJyZWFrCglkZWYgcHdsaXN0KHNlbGYpOgoJCXNlbGYucHc9cmF3X2lucHV0KCJbP10gUGFzc3dvcmQgOiAiKS5zcGxpdCgiLCIpCgkJaWYgbGVuKHNlbGYucHcpID09MDoKCQkJc2VsZi5wd2xpc3QoKQoJCWVsc2U6CgkJCWZvciBpIGluIHNlbGYuZmw6CgkJCQlpLnVwZGF0ZSh7InB3IjpzZWxmLnB3fSkKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoJ1vigKJdIEhhc2lsIE9rIFRlcnNpbXBhbiBEaSBPay50eHQnKQogICAgICAgICAgICAgICAgICAgICAgICBwcmludCgnW+KAol0gSGFzaWwgQ3AgVGVyc2ltcGFuIERpIENwLnR4dCcpCgkJCXByaW50KCfilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAnKQoJCQlUaHJlYWRQb29sKDMwKS5tYXAoc2VsZi5tYWluLHNlbGYuZmwpCgkJCW9zLnJlbW92ZShzZWxmLmFwaykKCQkJcHJpbnQgKCdbU2VsZXNhaV0nKQoJZGVmIG1haW4oc2VsZixmbCk6CgkJdHJ5OgoJCQlmb3IgaSBpbiBmbC5nZXQoInB3Iik6CgkJCQlsb2cgPSBtZmIoZmwuZ2V0KCdpZCcpLCBpLCAnaHR0cHM6Ly9tLmZhY2Vib29rLmNvbScpCgkJCQlpZiBsb2cuZ2V0KCJzdGF0dXMiKT09InN1Y2Nlc3MiOgoJCQkJCXByaW50KCJcclwwMzNbMDs5Mm1bT2tdICIrKGZsLmdldCgiaWQiKSsiXDAzM1swOzk3bSB8IFwwMzNbMDs5Mm0iK2krIiAiKSkKCQkJCQlzZWxmLmFkYS5hcHBlbmQoIiVzIHwgJXMiJShmbC5nZXQoImlkIiksaSkpCgkJCQkJaWYgZmwuZ2V0KCJpZCIpIGluIG9wZW4oIk9rLnR4dCIpLnJlYWQoKToKCQkJCQkJYnJlYWsKCQkJCQllbHNlOgoJCQkJCQlvcGVuKCJPay50eHQiLCJhKyIpLndyaXRlKAoJCQkJCQkiJXMgfCAlc1xuXG4iJShmbC5nZXQoImlkIiksaSxnZXRzX2Nvb2tpZXMobG9nLmdldCgiY29va2llcyIpKSkpCgkJCQkJa289IiVzIHwgJXNcblxuIiUoZmwuZ2V0KCJpZCIpLGksZ2V0c19jb29raWVzKGxvZy5nZXQoImNvb2tpZXMiKSkpCgkJCQkJYnJlYWsKCQkJCWVsaWYgbG9nLmdldCgic3RhdHVzIik9PSJjcCI6CgkJCQkJdHJ5OgoJCQkJCQl0b2tldD1vcGVuKCdsb2dpbi50eHQnLCdyJykucmVhZCgpCgkJCQkJCXE9cmVxdWVzdHMuZ2V0KCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8iK2ZsLmdldCgiaWQiKSsiP2FjY2Vzc190b2tlbj0iK3Rva2V0KQoJCQkJCQl3PWpzb24ubG9hZHMocS50ZXh0KQoJCQkJCQl0bD13WyJiaXJ0aGRheSJdCgoJCQkJCWV4Y2VwdCAoS2V5RXJyb3IsIElPRXJyb3IpOgoJCSAgICAgICAgICAgICAgICAgICAgICAgICB0bCA9ICIqUHJpdmF0ZSIKCQkJCQlleGNlcHQ6cGFzcwoJCQkJCXByaW50KCJcclwwMzNbMDs5M21bQ3BdICIrKGZsLmdldCgiaWQiKSsiIFwwMzNbMDs5N218XDAzM1swOzkzbSAiK2krIlwwMzNbMDs5M20gIit0bCsiICIpKQoJCQkJCXNlbGYuY3AuYXBwZW5kKCIlcyB8ICVzICVzIiUoZmwuZ2V0KCJpZCIpLGksdGwpKQoJCQkJCW9wZW4oIkNwLnR4dCIsImErIikud3JpdGUoCgkJCQkJCSIlcyB8ICVzICVzXG4iJShmbC5nZXQoImlkIiksaSx0bCkpCgkJCQkJYnJlYWsKCQkJCWVsc2U6Y29udGludWUKCQkJCQkKCQkJc2VsZi5rbys9MQoJCQlwcmludCAiXHJbQ3JhY2tdICVzLyVzICpPayA6ICVzIC0gKkNwIDogJXMiJShzZWxmLmtvLGxlbihzZWxmLmZsKSxsZW4oc2VsZi5hZGEpLGxlbihzZWxmLmNwKSksO3N5cy5zdGRvdXQuZmx1c2goKQoJCWV4Y2VwdDoKCQkJc2VsZi5tYWluKGZsKQpjbGFzcyBjcmFjazI6CglkZWYgX19pbml0X18oc2VsZik6CgkJc2VsZi5hZGE9W10KCQlzZWxmLmNwPVtdCgkJc2VsZi5rbz0wCgkJd2hpbGUgVHJ1ZToKCQkJcHJpbnQoJ+KUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCcpCgkJCWY9cmF3X2lucHV0KCJbP10gR3VuYWthbiBQYXNzIE1hbnVhbCAoeS90KSA6ICIpCgkJCWlmIGY9PSIiOmNvbnRpbnVlCgkJCWVsaWYgZj09InkiOgoJCQkJdHJ5OgoJCQkJCXdoaWxlIFRydWU6CgkJCQkJCXRyeToKCQkJCQkJCXNlbGYuYXBrPSAncm96aGFrLmpzb24nCgkJCQkJCQlzZWxmLmZzPW9wZW4oc2VsZi5hcGspLnJlYWQoKS5zcGxpdGxpbmVzKCkKCQkJCQkJCWJyZWFrCgkJCQkJCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCQkJCQkJCXByaW50KCdbeF0gRmlsZSBUaWRhayBBZGEnKQoJCQkJCQkJbWVudSgpCgkJCQkJCQljb250aW51ZQoJCQkJCXNlbGYuZmw9W10KCQkJCQlmb3IgaSBpbiBzZWxmLmZzOgoJCQkJCQl0cnk6CgkJCQkJCQlzZWxmLmZsLmFwcGVuZCh7ImlkIjppLnNwbGl0KCI8PT4iKVswXX0pCgkJCQkJCWV4Y2VwdDpjb250aW51ZQoJCQkJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgoJCQkJCXByaW50KCdbeF0gRmlsZSBUaWRhayBBZGEnKQoJCQkJCWNvbnRpbnVlCgkJCQlwcmludCgnW+KAol0gQ29udG9oIFBhc3MgOiBzYXlhbmcsYW5qaW5nJykKCQkJCXNlbGYucHdsaXN0KCkKCQkJCWJyZWFrCgkJCWVsaWYgZj09InQiOgoJCQkJdHJ5OgoJCQkJCXdoaWxlIFRydWU6CgkJCQkJCXRyeToKCQkJCQkJCXNlbGYuYXBrPSAncm96aGFrLmpzb24nCgkJCQkJCQlzZWxmLmZzPW9wZW4oc2VsZi5hcGspLnJlYWQoKS5zcGxpdGxpbmVzKCkKCQkJCQkJCWJyZWFrCgkJCQkJCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCQkJCQkJCXByaW50KCdbeF0gRmlsZSBUaWRhayBBZGEnKQoJCQkJCQkJbWVudSgpCgkJCQkJCQljb250aW51ZQoJCQkJCXNlbGYuZmw9W10KCQkJCQlmb3IgaSBpbiBzZWxmLmZzOgoJCQkJCQl0cnk6CgkJCQkJCQlzZWxmLmZsLmFwcGVuZCh7ImlkIjppLnNwbGl0KCI8PT4iKVswXSwicHciOmdlbmVyYXRlKGkuc3BsaXQoIjw9PiIpWzFdKX0pCgkJCQkJCWV4Y2VwdDpjb250aW51ZQoJCQkJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgoJCQkJCXByaW50KCdbeF0gRmlsZSBUaWRhayBWYWxpZCcpCgkJCQkJbWVudSgpCgkJCQkJY29udGludWUKCQkJCXByaW50KCdb4oCiXSBIYXNpbCBPayBUZXJzaW1wYW4gRGkgT2sudHh0JykKCQkJCXByaW50KCdb4oCiXSBIYXNpbCBDcCBUZXJzaW1wYW4gRGkgQ3AudHh0JykKCQkJCXByaW50KCfilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAnKQoJCQkJVGhyZWFkUG9vbCgzNSkubWFwKHNlbGYubWFpbixzZWxmLmZsKQoJCQkJb3MucmVtb3ZlKHNlbGYuYXBrKQoJCQkJcHJpbnQgKCdbU2VsZXNhaV0nKQoJCQkJYnJlYWsKCWRlZiBwd2xpc3Qoc2VsZik6CgkJc2VsZi5wdz1yYXdfaW5wdXQoIls/XSBQYXNzd29yZCA6ICIpLnNwbGl0KCIsIikKCQlpZiBsZW4oc2VsZi5wdykgPT0wOgoJCQlzZWxmLnB3bGlzdCgpCgkJZWxzZToKCQkJZm9yIGkgaW4gc2VsZi5mbDoKCQkJCWkudXBkYXRlKHsicHciOnNlbGYucHd9KQogICAgICAgICAgICAgICAgICAgICAgICBwcmludCgnW+KAol0gSGFzaWwgT2sgVGVyc2ltcGFuIERpIE9rLnR4dCcpCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCdb4oCiXSBIYXNpbCBDcCBUZXJzaW1wYW4gRGkgQ3AudHh0JykKCQkJcHJpbnQoJ+KUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCcpCgkJCVRocmVhZFBvb2woMzApLm1hcChzZWxmLm1haW4sc2VsZi5mbCkKCQkJb3MucmVtb3ZlKHNlbGYuYXBrKQoJCQlwcmludCAoJ1tTZWxlc2FpXScpCglkZWYgbWFpbihzZWxmLGZsKToKCQl0cnk6CgkJCWZvciBpIGluIGZsLmdldCgicHciKToKCQkJCWxvZz1mcmVlKGZsLmdldCgiaWQiKSwKCQkJCQlpLCJodHRwczovL2ZyZWUuZmFjZWJvb2suY29tIikKCQkJCWlmIGxvZy5nZXQoInN0YXR1cyIpPT0ic3VjY2VzcyI6CgkJCQkJcHJpbnQoIlxyXDAzM1swOzkybVtPa10gIisoZmwuZ2V0KCJpZCIpKyJcMDMzWzA7OTdtIHwgXDAzM1swOzkybSIraSsiICIpKQoJCQkJCXNlbGYuYWRhLmFwcGVuZCgiJXMgfCAlcyIlKGZsLmdldCgiaWQiKSxpKSkKCQkJCQlpZiBmbC5nZXQoImlkIikgaW4gb3BlbigiT2sudHh0IikucmVhZCgpOgoJCQkJCQlicmVhawoJCQkJCWVsc2U6CgkJCQkJCW9wZW4oIk9rLnR4dCIsImErIikud3JpdGUoCgkJCQkJCSIlcyB8ICVzXG5cbiIlKGZsLmdldCgiaWQiKSxpLGdldHNfY29va2llcyhsb2cuZ2V0KCJjb29raWVzIikpKSkKCQkJCQlrbz0iJXMgfCAlc1xuXG4iJShmbC5nZXQoImlkIiksaSxnZXRzX2Nvb2tpZXMobG9nLmdldCgiY29va2llcyIpKSkKCQkJCQlicmVhawoJCQkJZWxpZiBsb2cuZ2V0KCJzdGF0dXMiKT09ImNwIjoKCQkJCQl0cnk6CgkJCQkJCXRva2V0PW9wZW4oJ2xvZ2luLnR4dCcsJ3InKS5yZWFkKCkKCQkJCQkJcT1yZXF1ZXN0cy5nZXQoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyIrZmwuZ2V0KCJpZCIpKyI/YWNjZXNzX3Rva2VuPSIrdG9rZXQpCgkJCQkJCXc9anNvbi5sb2FkcyhxLnRleHQpCgkJCQkJCXRsPXdbImJpcnRoZGF5Il0KCgkJCQkJZXhjZXB0IChLZXlFcnJvciwgSU9FcnJvcik6CgkJICAgICAgICAgICAgICAgICAgICAgICAgIHRsID0gIipQcml2YXRlIgoJCQkJCWV4Y2VwdDpwYXNzCgkJCQkJcHJpbnQoIlxyXDAzM1swOzkzbVtDcF0gIisoZmwuZ2V0KCJpZCIpKyIgXDAzM1swOzk3bXxcMDMzWzA7OTNtICIraSsiXDAzM1swOzkzbSAiK3RsKyIgIikpCgkJCQkJc2VsZi5jcC5hcHBlbmQoIiVzIHwgJXMgJXMiJShmbC5nZXQoImlkIiksaSx0bCkpCgkJCQkJb3BlbigiQ3AudHh0IiwiYSsiKS53cml0ZSgKCQkJCQkJIiVzIHwgJXMgJXNcbiIlKGZsLmdldCgiaWQiKSxpLHRsKSkKCQkJCQlicmVhawoJCQkJZWxzZTpjb250aW51ZQoJCQkJCQoJCQlzZWxmLmtvKz0xCgkJCXByaW50ICJccltDcmFja10gJXMvJXMgKk9rIDogJXMgLSAqQ3AgOiAlcyIlKHNlbGYua28sbGVuKHNlbGYuZmwpLGxlbihzZWxmLmFkYSksbGVuKHNlbGYuY3ApKSw7c3lzLnN0ZG91dC5mbHVzaCgpCgkJZXhjZXB0OgoJCQlzZWxmLm1haW4oZmwpCgppZiBfX25hbWVfXz09J19fbWFpbl9fJzoKCW9zLnN5c3RlbSgnZ2l0IHB1bGwnKQoJbWVudSgpCg==
